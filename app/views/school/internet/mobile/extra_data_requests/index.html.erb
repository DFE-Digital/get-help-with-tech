<%- title = t('page_titles.your_requests') %>
<%- content_for :title, title %>
<%- content_for :before_content do %>
  <%- school_breadcrumbs(items: [
      { t('page_titles.school.internet.home.show.title') => internet_school_path(@school) },
      { t('page_titles.request_extra_mobile_data') => extra_data_guidance_internet_mobile_school_path(@school) },
      title
    ],
    user: @current_user,
    school: @school) %>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl">
      <%= title %>
    </h1>

    <p class="govuk-body">
      <%= govuk_button_link_to 'New request',
        extra_data_requests_type_internet_mobile_school_path(@school)
      %>
    </p>
  </div>
</div>

<% if @extra_mobile_data_requests.any? %>
  <table class="govuk-table">
    <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th class="govuk-table__header">Account holder</th>
        <th class="govuk-table__header">Mobile number</th>
        <th class="govuk-table__header">Mobile Network</th>
        <th class="govuk-table__header">Status</th>
      </tr>
    </thead>
    <tbody class="govuk-table__body">
      <%- for emd_request in @extra_mobile_data_requests do %>
        <tr class="govuk-table__row">
          <td class="govuk-table__cell"><%= emd_request.account_holder_name %></td>
          <td class="govuk-table__cell"><%= emd_request.device_phone_number %></td>
          <td class="govuk-table__cell"><%= emd_request.mobile_network.try(:brand) %></td>
          <td class="govuk-table__cell">
            <%= render ExtraMobileDataRequestStatusComponent.new(extra_mobile_data_request: emd_request) %>
          </td>
        </tr>
      <%- end %>
    </tbody>
  </table>
<% end %>
